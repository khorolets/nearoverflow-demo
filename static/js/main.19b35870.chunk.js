(this["webpackJsonpnearoverflow-front"]=this["webpackJsonpnearoverflow-front"]||[]).push([[0],{112:function(e,t){var n=Object({NODE_ENV:"production",PUBLIC_URL:"/nearoverflow-demo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).CONTRACT_NAME||"nearoverflow.testnet";e.exports=function(e){switch(e){case"production":case"development":return{networkId:"default",nodeUrl:"https://rpc.nearprotocol.com",contractName:n,walletUrl:"https://wallet.nearprotocol.com",helperUrl:"https://near-contract-helper.onrender.com"};case"staging":return{networkId:"staging",nodeUrl:"https://staging-rpc.nearprotocol.com/",contractName:n,walletUrl:"https://near-wallet-staging.onrender.com",helperUrl:"https://near-contract-helper-staging.onrender.com"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/nearoverflow-demo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:n};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"http://shared-test.nearprotocol.com:3030",contractName:n,masterAccount:"test.near"};case"ci-staging":return{networkId:"shared-test-staging",nodeUrl:"http://staging-shared-test.nearprotocol.com:3030",contractName:n,masterAccount:"test.near"};case"tatooine":return{networkId:"tatooine",nodeUrl:"https://rpc.tatooine.nearprotocol.com",contractName:n,walletUrl:"https://wallet.tatooine.nearprotocol.com"};default:throw Error("Unconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}},113:function(e,t,n){e.exports=n(188)},138:function(e,t){},140:function(e,t){},161:function(e,t){},167:function(e,t){},187:function(e,t,n){},188:function(e,t,n){"use strict";n.r(t);var a=n(6),r=n.n(a),o=n(54),c=n(105),s=n(0),l=n.n(s),u=n(27),i=n.n(u),m=n(33),p=n(11),d=n(107),h=n(43);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var f=n(32),v=n(29),E=n(17),w=n(18),g=n(19),b=n(20),O=n(191),q=n(196),_=n(190),k=function(e){var t=e.currentUser,n=e.signIn,a=e.signOut;return l.a.createElement(q.a,{fixed:"top",bg:"dark",variant:"dark",className:"justify-content-between"},l.a.createElement(q.a.Brand,null,l.a.createElement(f.b,{to:"/"},"NEARoverflow")),t&&l.a.createElement(_.a,{variant:"outline-light",onClick:a},"\u24c3 Log out"),!t&&l.a.createElement(_.a,{variant:"outline-light",onClick:n},"\u24c3 Log in"))};k.defaultProps={currentUser:null};var y=k,U=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={questionText:""},e.signIn=function(){e.props.wallet.requestSignIn(e.props.nearConfig.contractName,"NEAROverflow")},e.signOut=function(){e.props.wallet.signOut(),window.location.href="/nearoverflow-demo"},e}return Object(w.a)(n,[{key:"render",value:function(){return console.log("production"),l.a.createElement(l.a.Fragment,null,l.a.createElement(y,{currentUser:this.props.currentUser,signIn:this.signIn,signOut:this.signOut}),l.a.createElement(O.a,null,this.props.children))}}]),n}(l.a.Component);U.defaultProps={currentUser:null};var j=Object(p.b)((function(e){return{currentUser:e.commonReducer.currentUser,nearConfig:e.commonReducer.nearConfig,wallet:e.commonReducer.walletConnection}}),null)(U),C=n(193),I=n(111),R={questions:null},S="Nearoverflow/questions/set_questions",x=function(e){return function(t){t({type:S,payload:e})}},A=n(192),N=n(195),T=n(28),P=n.n(T),M=P()(10).times(Math.pow(10,24)).toFixed(),D=P()(1).times(Math.pow(10,24)).toFixed(),L=P()(1).times(Math.pow(10,16)).toFixed(),B=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={questionText:""},e.handleSubmit=function(t){return t.preventDefault(),e.state.questionText.length>0&&e.props.contract.create_question({content:e.state.questionText,reward:M},L,M),!1},e}return Object(w.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement(A.a,null,l.a.createElement(O.a,null,l.a.createElement(C.a,null,l.a.createElement(I.a,null,l.a.createElement("h1",null,"Ask a question!"),l.a.createElement("p",null,"Simply ask a question and give the reward to the correct answer (10 \u24c3)"),l.a.createElement(N.a,{onSubmit:this.handleSubmit},l.a.createElement(N.a.Group,null,l.a.createElement(N.a.Control,{type:"text",value:this.state.questionText,onChange:function(t){e.setState({questionText:t.target.value})},placeholder:"Post new quesion"})),l.a.createElement(_.a,{type:"submit",variant:"outline-dark"},"Post new quetsion"))))))}}]),n}(l.a.Component);B.defaultProps={currentUser:null};var W=Object(p.b)((function(e){return{contract:e.commonReducer.contract,currentUser:e.commonReducer.currentUser}}),null)(B),F=n(197),K=function(e){var t=e.title,n=e.number,a=e.active,r=e.className;return l.a.createElement("div",{className:"box ".concat(a?"active":""," ").concat(r)},l.a.createElement("span",null,t),l.a.createElement("span",{className:"number"},P()(n).times(Math.pow(10,-24)).toFixed(0)," \u24c3"))};K.defaultProps={active:!1,className:""};var Q=K,H=function(e){var t=e.questionId,n=e.answers,a=e.reward,r=e.author_account_id,o=e.content;return l.a.createElement(F.a,null,l.a.createElement(F.a.Body,null,l.a.createElement(O.a,null,l.a.createElement(C.a,null,l.a.createElement(I.a,{xs:2},l.a.createElement(Q,{active:n.filter((function(e){return!0===e.is_correct})).length>0,title:"Reward",number:a})),l.a.createElement(I.a,null,l.a.createElement(F.a.Text,{className:"author"},"@",r),l.a.createElement(F.a.Title,null,l.a.createElement(f.b,{to:"/".concat(t)},o))),l.a.createElement(I.a,{xs:2},l.a.createElement("div",{className:"box"},l.a.createElement("span",null,"Answers:"),l.a.createElement("span",{className:"number"},n.length)))))))};H.defaultProps={answers:[]};var z=H,G=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(){return Object(E.a)(this,n),t.apply(this,arguments)}return Object(w.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.contract.list_questions().then((function(t){return e.props.setQuestions(t)}))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,this.props.currentUser&&l.a.createElement(W,null),this.props.questions&&l.a.createElement(C.a,null,l.a.createElement(I.a,null,l.a.createElement("h2",null,"Questions:"))),l.a.createElement(C.a,null,l.a.createElement(I.a,null,this.props.questions&&Object.keys(this.props.questions).slice(0).reverse().map((function(t){return l.a.createElement(z,Object.assign({key:"question_".concat(t),questionId:t},e.props.questions[t]))})))))}}]),n}(l.a.Component);G.defaultProps={questions:null,currentUser:null};var J=Object(p.b)((function(e){return{contract:e.commonReducer.contract,currentUser:e.commonReducer.currentUser,questions:e.questionsReducer.questions}}),{setQuestions:x})(G),V=n(194),Y=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!1},e.handleMarkAsCorrect=function(t){e.setState({isLoading:!0},(function(){e.props.markAsCorrect(e.props.id)}))},e.handleUpvote=function(t){e.props.upvoteAnswer(e.props.id)},e}return Object(w.a)(n,[{key:"render",value:function(){var e=this.props,t=e.account_id,n=e.content,a=e.reward,r=e.is_correct;return l.a.createElement(F.a,null,l.a.createElement(F.a.Body,null,l.a.createElement(O.a,null,l.a.createElement(C.a,null,l.a.createElement(I.a,{xs:2},l.a.createElement(Q,{active:r,title:"Reward",number:a}),l.a.createElement(_.a,{block:!0,className:"upvote",variant:"outline-dark",sime:"sm",onClick:this.handleUpvote},"Upvote 1 \u24c3")),l.a.createElement(I.a,null,!this.props.questionIsLocked&&this.props.currentUser&&this.props.currentUser.accountId===this.props.questionAuthor&&l.a.createElement(_.a,{className:"mark-as-correct",variant:"outline-success",size:"sm",onClick:this.handleMarkAsCorrect},this.state.isLoading?l.a.createElement(V.a,{animation:"border",size:"sm"}):"Mark as correct"),l.a.createElement(F.a.Text,{className:"author"},"@",t),l.a.createElement(F.a.Title,null,n))))))}}]),n}(l.a.Component),$=Object(p.b)((function(e){return{contract:e.commonReducer.contract,currentUser:e.commonReducer.currentUser}}),null)(Y),X=n(198),Z=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={content:""},e.handleSubmit=function(t){return t.preventDefault(),e.state.content.length>0&&e.props.contract.create_answer({question_id:parseInt(e.props.questionId,10),content:e.state.content},L,D).then((function(){e.setState({content:""})})),!1},e}return Object(w.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement(C.a,null,l.a.createElement(I.a,null,l.a.createElement(F.a,{className:"form-card"},l.a.createElement(F.a.Body,null,l.a.createElement(F.a.Title,null,"Post Answer"),l.a.createElement(N.a,{onSubmit:this.handleSubmit},l.a.createElement(N.a.Group,null,l.a.createElement(N.a.Control,{type:"text",placeholder:"Answer",value:this.state.content,onChange:function(t){return e.setState({content:t.target.value})}})),l.a.createElement(X.a,{variant:"secondary"},"To post an answer costs 1 \u24c3 but then you have a chance to grab the question reward."),l.a.createElement(_.a,{type:"submit",variant:"outline-dark"},"Submit answer"))))))}}]),n}(l.a.Component),ee=Object(p.b)((function(e){return{contract:e.commonReducer.contract}}),null)(Z),te=function(e){Object(b.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).markAsCorrect=function(t){var n=e.props.match.params.questionId,a=e.props.questions[n],r=a.answers.filter((function(e){return e.id===t}))[0];return a.answers.filter((function(e){return!0===e.is_correct})).length>0?(alert("ERROR: This question already has correct answer"),!1):(e.props.currentUser&&e.props.currentUser.accountId===a.author_account_id&&e.props.currentUser.accountId!==r.account_id?e.props.contract.set_correct_answer({question_id:parseInt(n,10),answer_id:t}).then((function(){e.props.contract.list_questions().then((function(t){return e.props.setQuestions(t)}))})):alert("ERROR: You're not allowed to perform this action"),!1)},e.upvote=function(t){var n=e.props.match.params.questionId;e.props.contract.upvote_answer({question_id:parseInt(n,10),answer_id:t},L,P()(1).times(Math.pow(10,24)).toFixed())},e}return Object(w.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.questions||this.props.contract.list_questions().then((function(t){return e.props.setQuestions(t)}))}},{key:"render",value:function(){var e=this,t=this.props.match.params.questionId;if(!this.props.questions)return null;var n=this.props.questions[t];if(!n)return null;var a=n.answers.filter((function(e){return!0===e.is_correct})).length>0;return l.a.createElement(l.a.Fragment,null,l.a.createElement(C.a,null,l.a.createElement(I.a,null,l.a.createElement(F.a,null,l.a.createElement(F.a.Body,null,l.a.createElement(O.a,null,l.a.createElement(C.a,null,l.a.createElement(I.a,{xs:2},l.a.createElement(Q,{active:a,title:"Reward",number:n.reward})),l.a.createElement(I.a,null,l.a.createElement(F.a.Text,{className:"author"},"@",n.author_account_id),l.a.createElement(F.a.Title,null,n.content)))))))),n.answers.length>0&&l.a.createElement(C.a,null,l.a.createElement(I.a,null,l.a.createElement("h2",null,"Answers: "),n.answers.map((function(t){return l.a.createElement($,Object.assign({questionIsLocked:a,questionAuthor:n.author_account_id,markAsCorrect:e.markAsCorrect,upvoteAnswer:e.upvote,key:"answer_".concat(t.id)},t))})))),l.a.createElement(ee,{questionId:this.props.match.params.questionId}))}}]),n}(l.a.Component);te.defaultProps={questions:null,currentUser:null};var ne=Object(v.f)(Object(p.b)((function(e){return{contract:e.commonReducer.contract,currentUser:e.commonReducer.currentUser,questions:e.questionsReducer.questions}}),{setQuestions:x})(te)),ae=function(){return l.a.createElement(f.a,null,l.a.createElement(j,null,l.a.createElement(v.c,null,l.a.createElement(v.a,{exact:!0,path:"/"},l.a.createElement(J,null)),l.a.createElement(v.a,{path:"/:questionId"},l.a.createElement(ne,null)))))},re=n(112),oe=n.n(re),ce={contract:null},se=Object(m.c)({commonReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce;arguments.length>1&&arguments[1];return e},questionsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(o.a)({},e,{questions:t.payload});default:return e}}}),le=(n(187),Object(m.a)(d.a)(m.d));function ue(){return(ue=Object(c.a)(r.a.mark((function e(){var t,n,a,c,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=oe()("development"),e.next=3,h.connect(Object(o.a)({deps:{keyStore:new h.keyStores.BrowserLocalStorageKeyStore}},t));case 3:if(n=e.sent,!(a=new h.WalletConnection(n)).getAccountId()){e.next=11;break}return e.t0=a.getAccountId(),e.next=9,a.account().state();case 9:e.t1=e.sent.amount,c={accountId:e.t0,balance:e.t1};case 11:return e.next=13,new h.Contract(a.account(),t.contractName,{viewMethods:["list_questions"],changeMethods:["create_question","create_answer","upvote_answer","set_correct_answer"],sender:a.getAccountId()});case 13:return s=e.sent,e.abrupt("return",{contract:s,currentUser:c,nearConfig:t,walletConnection:a});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.nearInitPromise=function(){return ue.apply(this,arguments)}().then((function(e){i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(p.a,{store:le(se,{commonReducer:e})},l.a.createElement(ae,null))),document.getElementById("root"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[113,1,2]]]);
//# sourceMappingURL=main.19b35870.chunk.js.map